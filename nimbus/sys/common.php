<?php
/** 
 * Nimbus - Manage, Share & Collaborate
 *
 * Nimbus is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * see LICENSE for more Copyright goodness.
 *
 * @package:		Nimbus
 * @copyright:		2009-2010, Nimbus Dev Group, All rights reserved.
 * @license:		GNU/GPLv3, see LICENSE
 * @version:		1.0.0 Alpha
 */
/**
 * @ignore
 *   This file contains functions and definitions used throughout the Nimbus
 *   system. Please do not edit this file to prevent System breakdown.
 */
/**
 * Function to check compatibility for the environment
 *
 * @access	public
 */
function checkCompatibility(){
	$incompatibilities = array();
	$missing = array();

	/**
	 * Check PHP environment
	 */
	if (!version_compare(PHP_VERSION, '5.3', '>=')) {
		$incompatibilities[] = array($language['compat_error_000A'], '000A');
	}
	if (!extension_loaded('sqlite') && !extension_loaded('pdo_sqlite')) {
		$incompatibilities[] = array($language['compat_error_001A'], '001A');
	}
	if ((!is_writable('/../.nimbus') && !is_readable('/../.nimbus')) && (!is_writable('../nimbus') && !is_readable('../nimbus'))) {
		$incompatibilities[] = array($language['compat_error_002A'], '002A');
	}
	if (!ini_get('file_uploads')) {
		$incompatibilities[] = array($language['compat_error_003A'], '003A');
	}

	/**
	 * Check for Optional Extensions
	 */
	if (!extension_loaded('mbstring')) {
		$missing[] = array($language['compat_error_000B'], '000B');
	}
	if (!extension_loaded('ftp')) {
		$missing[] = array($language['compat_error_001B'], '001B');
	}
	if (!extension_loaded('json')) {
		$missing[] = array($language['compat_error_002B'], '002B');
	}
	if (!extension_loaded('soap')) {
		$missing[] = array($language['compat_error_003B'], '003B');
	}
	if (!extension_loaded('xml') && !extension_loaded('xmlreader') && !extension_loaded('xmlwriter')) {
		$missing[] = array($language['compat_error_004B'], '004B');
	}
	if (!extension_loaded('xmlrpc')) {
		$missing[] = array($language['compat_error_005B'], '005B');
	}
	if (!extension_loaded('zip')) {
		$missing[] = array($language['compat_error_006B'], '006B');
	}
	if (!extension_loaded('zlib')) {
		$missing[] = array($language['compat_error_007B'], '007B');
	}
	if (!function_exists('mail')) {
		$missing[] = array($language['compat_error_008B'], '008B');
	}

	/**
	 * End the application when an incompatibility has been determined
	 */
	if (!empty($incompatibilities)) {
		include SYSTEM_DIR . 'shell' . DS . 'common' . DS . 'compatibility.html';
		exit;
	}
}

?>